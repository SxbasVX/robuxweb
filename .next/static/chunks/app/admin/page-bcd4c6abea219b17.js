(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{3422:function(e,a,t){Promise.resolve().then(t.bind(t,683))},683:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return h}});var s=t(7437),r=t(2265),l=t(3259),o=t(1180),i=t(6758),n=t(9831);async function d(e,a){let t=(0,o.S)();try{let{data:s,error:r}=await t.from("users").upsert({id:e,email:a,role:"admin"},{onConflict:"id"});if(r)return console.error("Error restaurando rol de admin:",r),{success:!1,error:r.message};return console.log("Rol de administrador restaurado exitosamente:",s),{success:!0,data:s}}catch(e){return console.error("Error inesperado:",e),{success:!1,error:"Error inesperado"}}}function c(){let[e,a]=(0,r.useState)(!1),[t,s]=(0,r.useState)(null),[l,i]=(0,r.useState)([]),n=(0,r.useCallback)(async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"manual";if(e)return{success:!1,error:"Backup en progreso"};a(!0);try{let e=(0,o.S)(),a=new Date().toISOString(),r=crypto.randomUUID(),[l,n,d,c]=await Promise.all([e.from("posts").select("*").then(e=>e.data||[]),e.from("comentarios").select("*").then(e=>e.data||[]),e.from("students").select("*").then(e=>e.data||[]),e.from("users").select("*").then(e=>e.data||[])]),u=l.length+n.length+d.length+c.length,m="backup_".concat(a.split("T")[0],"_").concat(Date.now(),".json"),x=JSON.stringify({metadata:{id:r,created_at:a,version:"1.0"},data:{posts:l,comentarios:n,students:d,users:c},statistics:{total_records:u}},null,2),g=JSON.parse(localStorage.getItem("backupHistory")||"[]"),h=[{id:r,created_at:a,type:t,records_count:u,status:"completed",file_name:m},...g.slice(0,9)];localStorage.setItem("backupHistory",JSON.stringify(h)),i(h),s(a),await e.from("backups").insert({id:r,created_at:a,type:t,records_count:u,status:"completed",file_name:m,backup_json:x});let p=new Blob([x],{type:"application/json"}),b=URL.createObjectURL(p),f=document.createElement("a");return f.href=b,f.download=m,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(b),{success:!0,data:{id:r,records:u,timestamp:a,fileName:m}}}catch(e){return{success:!1,error:"Error al crear backup"}}finally{a(!1)}},[e]),d=(0,r.useCallback)(async()=>{var e;let a=JSON.parse(localStorage.getItem("backupHistory")||"[]");return a.length>0&&(s(a[0].created_at),i(a)),{success:!0,lastBackup:(null===(e=a[0])||void 0===e?void 0:e.created_at)||null}},[]),c=(0,r.useCallback)(async e=>{let a=JSON.parse(localStorage.getItem("backupHistory")||"[]").find(a=>a.id===e);return a?{success:!0,data:a}:{success:!1,error:"Backup no encontrado"}},[]),u=(0,r.useCallback)(e=>{var a;let t=JSON.parse(localStorage.getItem("backupHistory")||"[]").filter(a=>a.id!==e);localStorage.setItem("backupHistory",JSON.stringify(t)),i(t),s((null===(a=t[0])||void 0===a?void 0:a.created_at)||null)},[]),m=(0,r.useRef)(null);return(0,r.useEffect)(()=>(d(),m.current||(m.current=setInterval(()=>{n("automatic")},864e5)),()=>{m.current&&clearInterval(m.current)}),[d,n]),{createBackup:n,getBackupStatus:d,loadBackup:c,deleteBackup:u,isLoading:e,lastBackup:t,backupList:l}}var u=t(5976),m=t(5506);function x(){let{user:e}=(0,l.a)(),{getStats:a}=(0,m.RC)(),{lastBackup:t}=c(),{getStats:o}=(0,u.z)(),[i,n]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{try{let t=a(),s=o(),r=t.total>=0&&s.total>=0&&null!==e;n(r)}catch(e){console.error("Error checking systems:",e),n(!1)}})()},[e,a,o]);let d=[{name:"Rate Limiting",status:"✅ Activo",description:"Protecci\xf3n contra spam y ataques (10 posts/hora)",color:"text-green-400"},{name:"Audit Logging",status:"✅ Funcional",description:"Registro completo de actividades del sistema",color:"text-green-400"},{name:"Backup Autom\xe1tico",status:t?"✅ Configurado":"⚠️ Pendiente",description:t?"\xdaltimo: ".concat(new Date(t).toLocaleString("es-ES")):"Primer backup pendiente",color:t?"text-green-400":"text-yellow-400"},{name:"Notificaciones",status:"✅ Operativo",description:"Sistema de notificaciones en tiempo real",color:"text-green-400"},{name:"Roles y Permisos",status:"✅ Configurado",description:"Control de acceso basado en roles (Admin/Delegado/Usuario)",color:"text-green-400"},{name:"PWA Support",status:"✅ Incluido",description:"Aplicaci\xf3n web progresiva con soporte offline",color:"text-green-400"}];return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"glass p-6 rounded-2xl border-l-4 border-green-500",children:(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-white",children:"\uD83D\uDE80 Estado de Producci\xf3n"}),(0,s.jsx)("p",{className:"text-gray-400",children:"Sistema listo para lanzamiento con todas las caracter\xedsticas de producci\xf3n"})]}),(0,s.jsx)("div",{className:"px-4 py-2 rounded-lg font-semibold ".concat(i?"bg-green-500/20 text-green-400 border border-green-500/50":"bg-yellow-500/20 text-yellow-400 border border-yellow-500/50"),children:i?"\uD83D\uDFE2 LISTO":"\uD83D\uDFE1 VERIFICANDO"})]})}),(0,s.jsxs)("div",{className:"glass p-6 rounded-2xl",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"\uD83D\uDCCB Caracter\xedsticas Implementadas"}),(0,s.jsx)("div",{className:"grid md:grid-cols-2 gap-4",children:d.map((e,a)=>(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl border border-white/10",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,s.jsx)("h4",{className:"text-white font-medium",children:e.name}),(0,s.jsx)("span",{className:"text-sm font-semibold ".concat(e.color),children:e.status})]}),(0,s.jsx)("p",{className:"text-gray-400 text-sm",children:e.description})]},a))})]}),(0,s.jsxs)("div",{className:"glass p-6 rounded-2xl",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"\uD83D\uDD27 Instrucciones de Despliegue"}),(0,s.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,s.jsxs)("div",{className:"bg-blue-500/10 border border-blue-500/30 p-3 rounded-lg",children:[(0,s.jsx)("strong",{className:"text-blue-400",children:"1. Variables de Entorno:"}),(0,s.jsx)("div",{className:"text-gray-300 mt-1",children:"Aseg\xfarate de que todas las variables de Supabase est\xe9n configuradas en producci\xf3n"})]}),(0,s.jsxs)("div",{className:"bg-green-500/10 border border-green-500/30 p-3 rounded-lg",children:[(0,s.jsx)("strong",{className:"text-green-400",children:"2. Base de Datos:"}),(0,s.jsx)("div",{className:"text-gray-300 mt-1",children:"El sistema incluye RLS (Row Level Security) y todas las tablas necesarias"})]}),(0,s.jsxs)("div",{className:"bg-purple-500/10 border border-purple-500/30 p-3 rounded-lg",children:[(0,s.jsx)("strong",{className:"text-purple-400",children:"3. Cuentas de Usuario:"}),(0,s.jsx)("div",{className:"text-gray-300 mt-1",children:"Las cuentas se crean manualmente desde el panel de administraci\xf3n"})]}),(0,s.jsxs)("div",{className:"bg-orange-500/10 border border-orange-500/30 p-3 rounded-lg",children:[(0,s.jsx)("strong",{className:"text-orange-400",children:"4. Monitoreo:"}),(0,s.jsx)("div",{className:"text-gray-300 mt-1",children:"Usa el panel de administraci\xf3n para monitorear logs, backups y actividad"})]})]})]}),(0,s.jsxs)("div",{className:"glass p-6 rounded-2xl",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"\uD83D\uDCCA Estad\xedsticas del Sistema"}),(0,s.jsxs)("div",{className:"grid md:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-400",children:a().total}),(0,s.jsx)("div",{className:"text-gray-400 text-sm",children:"Eventos auditados"})]}),(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-green-400",children:o().total}),(0,s.jsx)("div",{className:"text-gray-400 text-sm",children:"Notificaciones"})]}),(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-purple-400",children:t?"✅":"⏳"}),(0,s.jsx)("div",{className:"text-gray-400 text-sm",children:"Backup Status"})]}),(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-yellow-400",children:"100%"}),(0,s.jsx)("div",{className:"text-gray-400 text-sm",children:"Uptime"})]})]})]})]})}function g(){let{user:e}=(0,l.a)(),[a,t]=(0,r.useState)([]),[g,h]=(0,r.useState)(!0),[p,b]=(0,r.useState)(null),[f,v]=(0,r.useState)(null),[j,N]=(0,r.useState)(""),[D,y]=(0,r.useState)(1),[w,E]=(0,r.useState)(!1),[C,S]=(0,r.useState)("production"),[k,A]=(0,r.useState)(""),[L,R]=(0,r.useState)(""),{createBackup:O,getBackupStatus:_,loadBackup:I,deleteBackup:B,isLoading:U,lastBackup:z,backupList:T}=c();(0,r.useCallback)(async()=>{(await O("manual")).success?alert("✅ Backup de prueba creado y guardado en Supabase"):alert("❌ Error al crear backup de prueba")},[O]);let q=(0,r.useCallback)(async()=>{try{await (0,o.S)().from("logs").insert({id:crypto.randomUUID(),timestamp:new Date().toISOString(),user_id:(null==e?void 0:e.id)||"test",user_email:(null==e?void 0:e.email)||"test@demo.com",action:"test_log",level:"info",details:{test:!0,message:"Log de prueba desde el panel"},ip_address:"local",user_agent:navigator.userAgent}),alert("✅ Log de prueba guardado en Supabase")}catch(e){alert("❌ Error al guardar log de prueba")}},[e]),{notifications:P,markAsRead:M,markAllAsRead:F,deleteNotification:G,deleteAllNotifications:J,createNotification:V,getStats:H,cleanExpiredNotifications:W}=(0,u.z)(),{getLogs:Y,getStats:Z,clearLogs:K,exportLogs:Q}=(0,m.RC)(),X=async()=>{console.log("\uD83D\uDD04 Iniciando carga de usuarios..."),h(!0);try{let e=(0,o.S)(),{data:a,error:s}=await e.from("users").select("*");if(console.log("\uD83D\uDCCA Datos recibidos de Supabase:",a),s)throw console.error("❌ Error al cargar usuarios:",s),s;let r=(null!=a?a:[]).map(e=>({id:e.id,data:e}));console.log("\uD83D\uDC65 Usuarios mapeados:",r.length,"usuarios"),t(r),v(null)}catch(a){var e;console.error("\uD83D\uDCA5 Error completo en loadUsers:",a),v(null!==(e=a.message)&&void 0!==e?e:"Error al cargar datos")}finally{h(!1)}};(0,r.useEffect)(()=>{X(),_()},[_]);let $=async()=>{try{let a=await O();if(a.success){var e;await _(),alert("✅ Backup creado: ".concat(null===(e=a.data)||void 0===e?void 0:e.records," registros"))}else alert("❌ Error al crear backup")}catch(e){console.error("Error creando backup:",e),alert("❌ Error al crear backup")}},ee=async e=>{try{let a=(0,o.S)(),{data:t,error:s}=await a.from("users").select("*").eq("id",e).single();if(s)throw s;let r=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),l=URL.createObjectURL(r),i=document.createElement("a");i.href=l,i.download="user_data_".concat(e,"_").concat(new Date().toISOString().split("T")[0],".json"),document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(l)}catch(e){console.error("Error exportando datos:",e)}},ea=async()=>{if(!j.trim()){v("Email es requerido");return}E(!0);try{let e=(0,o.S)(),{data:a}=await e.from("users").select("id").eq("email",j.trim()).single();if(a){v("Ya existe un usuario con ese email"),E(!1);return}let t=crypto.randomUUID(),{error:s}=await e.from("users").insert({id:t,email:j.trim(),role:"delegado",group:D});if(s)throw s;N(""),await X(),await _()}catch(a){var e;v(null!==(e=a.message)&&void 0!==e?e:"Error al crear delegado")}finally{E(!1)}},et=async(e,a,t)=>{try{let s=(0,o.S)(),{error:r}=await s.from("users").update({role:a,group:t}).eq("id",e);if(r)throw r;await X()}catch(e){var s;v(null!==(s=e.message)&&void 0!==s?s:"Error al guardar cambios")}},es=async()=>{if(confirm("\xbfRestaurar rol de administrador para admin@admin.com?"))try{let e=await d("2545304c-b9c2-4d8d-a413-93dad3f38007","admin@admin.com");e.success?(v(null),await X(),alert("Rol de administrador restaurado exitosamente")):v(e.error||"Error al restaurar administrador")}catch(a){var e;v(null!==(e=a.message)&&void 0!==e?e:"Error inesperado")}},er=async e=>{let s=a.find(a=>a.id===e),r=s?"".concat(s.data.email||s.id):e;if(!confirm('\xbfEst\xe1s seguro de que quieres eliminar al usuario "'.concat(r,'"?\n\nEsta acci\xf3n no se puede deshacer.')))return;b(e);let l=[...a];t(a=>a.filter(a=>a.id!==e));try{var i;let a=(0,o.S)();console.log("\uD83D\uDD04 Iniciando eliminaci\xf3n del usuario: ".concat(e)),console.log("Usuario encontrado:",s);let{data:n}=await a.auth.getUser();console.log("Usuario autenticado:",null==n?void 0:null===(i=n.user)||void 0===i?void 0:i.email),console.log("\uD83D\uDCE4 Ejecutando DELETE en la tabla users...");let{data:d,error:c,count:u}=await a.from("users").delete().eq("id",e);if(console.log("Respuesta de eliminaci\xf3n:",{data:d,error:c,count:u}),c)throw console.error("❌ Error de Supabase:",c),t(l),Error("Error de base de datos: ".concat(c.message));console.log("✅ Usuario ".concat(e," eliminado exitosamente")),setTimeout(async()=>{console.log("\uD83D\uDD0D Verificando eliminaci\xf3n...");let{data:t}=await a.from("users").select("id").eq("id",e);t&&t.length>0?(console.warn("⚠️ El usuario a\xfan existe en la base de datos, recargando lista..."),await X()):console.log("✅ Eliminaci\xf3n verificada correctamente")},1e3),alert('✅ Usuario "'.concat(r,'" eliminado exitosamente'))}catch(a){console.error("\uD83D\uDCA5 Error completo al eliminar usuario:",a);let e=a.message||"Error desconocido al eliminar usuario";v("Error al eliminar usuario: ".concat(e)),alert("❌ Error al eliminar usuario: ".concat(e)),t(l)}finally{b(null)}},el=async()=>{if(confirm('⚠️ \xbfEst\xe1s COMPLETAMENTE SEGURO de que quieres borrar TODOS los posts y archivos?\n\nEsta acci\xf3n NO SE PUEDE DESHACER.\n\nEscribe "BORRAR TODO" para confirmar:')){if("BORRAR TODO"!==prompt("Para confirmar, escribe exactamente: BORRAR TODO")){alert("Confirmaci\xf3n incorrecta. Operaci\xf3n cancelada.");return}h(!0);try{let e=(0,o.S)();console.log("\uD83D\uDDD1️ Iniciando eliminaci\xf3n masiva de contenido...");let{error:a}=await e.from("posts").delete().neq("id","");if(a)throw Error("Error al borrar posts: ".concat(a.message));console.log("✅ Posts eliminados");let{error:t}=await e.from("comments").delete().neq("id","");t?console.warn("⚠️ Error al borrar comentarios:",t.message):console.log("✅ Comentarios eliminados");try{let{data:a}=await e.storage.from("grupos").list();if(a&&a.length>0){let t=a.map(e=>e.name),{error:s}=await e.storage.from("grupos").remove(t);s?console.warn("⚠️ Error al borrar archivos de grupos:",s.message):console.log("✅ Archivos de grupos eliminados")}let{data:t}=await e.storage.from("public").list();if(t&&t.length>0){let a=t.map(e=>e.name),{error:s}=await e.storage.from("public").remove(a);s?console.warn("⚠️ Error al borrar archivos p\xfablicos:",s.message):console.log("✅ Archivos p\xfablicos eliminados")}}catch(e){console.warn("⚠️ Error al acceder al storage:",e)}let{error:s}=await e.from("group_home_data").delete().neq("id","");s?console.warn("⚠️ Error al borrar datos de home:",s.message):console.log("✅ Datos de home de grupos eliminados"),alert("\uD83C\uDF89 \xa1Eliminaci\xf3n completada! Todos los posts, comentarios y archivos han sido borrados. La plataforma est\xe1 lista para el lanzamiento.")}catch(e){console.error("❌ Error durante la eliminaci\xf3n masiva:",e),alert("❌ Error durante la eliminaci\xf3n: ".concat(e.message))}finally{h(!1)}}},eo=async()=>{if(confirm("⚠️ \xbfEst\xe1s COMPLETAMENTE SEGURO de que quieres borrar TODOS los usuarios (excepto administradores)?\n\nEsta acci\xf3n NO SE PUEDE DESHACER.")){h(!0);try{let e=(0,o.S)(),{error:a}=await e.from("users").delete().neq("role","admin");if(a)throw Error("Error al borrar usuarios: ".concat(a.message));await X(),alert("✅ Todos los usuarios no-administradores han sido eliminados.")}catch(e){console.error("❌ Error al borrar usuarios:",e),alert("❌ Error: ".concat(e.message))}finally{h(!1)}}},ei=async()=>{if(confirm("\xbfActualizar los nombres de autores en todos los posts existentes?")){h(!0);try{let e=(0,o.S)();console.log("\uD83D\uDD27 Actualizando nombres de autores...");let{data:a,error:t}=await e.from("posts").select("id, autor, autorNombre");if(t)throw Error("Error al obtener posts: ".concat(t.message));if(!a||0===a.length){alert("✅ No hay posts para actualizar.");return}let s=[...new Set(a.map(e=>e.autor))],{data:r,error:l}=await e.from("users").select("id, email, role").in("id",s);if(l)throw Error("Error al obtener usuarios: ".concat(l.message));let i={};null==r||r.forEach(e=>{let a;a="admin"===e.role?"Administrador":"delegado"===e.role?"Delegado":e.email?e.email.split("@")[0]:e.id,i[e.id]=a});let n=0;for(let t of a){let a=i[t.autor]||t.autor,{error:s}=await e.from("posts").update({autorNombre:a}).eq("id",t.id);s?console.warn("Error actualizando post ".concat(t.id,":"),s.message):n++}let{data:d,error:c}=await e.from("comments").select("id, autor, autorNombre").or("autorNombre.is.null,autorNombre.eq.");if(!c&&d&&d.length>0)for(let a of d){let t=i[a.autor]||a.autor;await e.from("comments").update({autorNombre:t}).eq("id",a.id)}alert("✅ Nombres de autores actualizados! ".concat(n," posts y ").concat((null==d?void 0:d.length)||0," comentarios procesados."))}catch(e){console.error("❌ Error al actualizar nombres:",e),alert("❌ Error: ".concat(e.message))}finally{h(!1)}}},en=async()=>{if(confirm("\xbfActualizar la base de datos con la nueva lista de integrantes de grupos?")){h(!0);try{let e=(0,o.S)();console.log("\uD83D\uDC65 Actualizando integrantes de grupos...");let a=[{groupId:1,members:[{name:"Vilca Cruz Marsia Gianella Katherine",email:"marsia.vilcac@unmsm.edu.pe",code:"25010238"},{name:"Luna Viilca Sahara Dula",email:"luna.vilcac@unmsm.edu.pe",code:"25010282"},{name:"Romani Medina Nadit Liliana",email:"nadit.romanim@unmsm.edu.pe",code:"25010578"},{name:"Maza Morales Benjamin Pedro",email:"benjamin.mazam@unmsm.edu.pe",code:"25010236"},{name:"Damjanovic Burga Yenko Branko",email:"yenko.damjanovicb@unmsm.edu.pe",code:"25010014"},{name:"Navarro Cespedes Sunny Adriana",email:"sunny.navarr.ocg@unmsm.edu.pe",code:"25010031"}]},{groupId:2,members:[{name:"Palomino Huamani Judit Gabriela",email:"judit.palominoh@unmsm.edu.pe",code:"25010434"},{name:"Asuncion Pomasonco Allison Giselle",email:"allison.asuncionp@unmsm.edu.pe",code:"25010007"},{name:"Martinez Gomez Alvaro Jose",email:"alvaro.martinezg@unmsm.edu.pe",code:"25010126"},{name:"Yaranga Mejia Zharick Scarlett",email:"zharick.yarangam@unmsm.edu.pe",code:"25010393"},{name:"Maquera Mendoza Bryan Antony",email:"bryan.maqueram@unmsm.edu.pe",code:"25010427"},{name:"Luque Leayza David Mauricio",email:"david.luquel@unmsm.edu.pe",code:"25010028"}]},{groupId:3,members:[{name:"Quispe Abtao Jhack Hildibrahan",email:"jhack.quispea@unmsm.edu.pe",code:"25010297"},{name:"Reyes Mendieta Karla Fernanda",email:"karla.reyesm@unmsm.edu.pe",code:"25010093"},{name:"Hanampa Bellido Luz Berli",email:"luz.hanampab@unmsm.edu.pe",code:"25010336"},{name:"Gonzales Lopez Lulio Main",email:"lulio.gonzalesl@unmsm.edu.pe",code:"25010478"},{name:"Ballon Ramos Robert Andres",email:"robert.ballonr@unmsm.edu.pe",code:"25010149"}]},{groupId:4,members:[{name:"Martinez Lugue Claudia Alexandra",email:"claudia.martinezl@unmsm.edu.pe",code:"25010127"},{name:"Morales Damian Andrea Katherine",email:"andrea.moralesd@unmsm.edu.pe",code:"20010327"},{name:"Josue Osorio Anghely Cristal",email:"anghely.josueo@unmsm.edu.pe",code:"25010330"},{name:"Espinoza Carde\xf1a Alessandra Abyael",email:"alessandra.espinozac@unmsm.edu.pe",code:"25010360"},{name:"Granada Juarez Alejandra",email:"alejandra.granadaj@unmsm.edu.pe",code:"25010687"}]},{groupId:5,members:[{name:"Balbin Cueva Aaron",email:"aaron.balbinc@unmsm.edu.pe",code:"25010473"},{name:"Carrillo Castillo Brenda",email:"brenda.carrilloc@unmsm.edu.pe",code:"25010353"},{name:"Hurtado Dominguez Angel Valeria",email:"angel.hurtadod@unmsm.edu.pe",code:"25010240"},{name:"Marcelo Diego Francesco",email:"francesco.marcelod@unmsm.edu.pe",code:"25010173"},{name:"Medina Vera Arturo Alexis",email:"arturo.medinav@unmsm.edu.pe",code:"25010483"},{name:"Obregon Castro Jhesbelt Anadira",email:"jhesbelt.obregonc@unmsm.edu.pe",code:"25010486"},{name:"Ramon Ipushima Ilan Yefet",email:"ilan.ramoni@unmsm.edu.pe",code:"25010196"}]}],{error:t}=await e.from("users").delete().neq("role","admin");t?console.warn("⚠️ Error al limpiar usuarios existentes:",t.message):console.log("✅ Usuarios no-admin existentes eliminados");let s=0;for(let t of a)for(let a of t.members){let{error:r}=await e.from("users").insert({email:a.email,role:"usuario",group:t.groupId,full_name:a.name,created_at:new Date().toISOString(),updated_at:new Date().toISOString()});r?console.warn("⚠️ Error insertando usuario ".concat(a.name,":"),r.message):s++}alert("✅ Integrantes de grupos actualizados! ".concat(s," estudiantes insertados en ").concat(a.length," grupos."))}catch(e){console.error("❌ Error al actualizar grupos:",e),alert("❌ Error: ".concat(e.message))}finally{h(!1)}}},ed=async()=>{h(!0);try{let e=(0,o.S)();console.log("\uD83D\uDD0D Verificando estudiantes en la base de datos...");let{data:a,error:t}=await e.from("users").select("*").eq("role","usuario"),{data:s,error:r}=await e.from("users").select("*"),l="\uD83D\uDCCA Reporte de Estudiantes:\n\n";if(t?l+="❌ Error en tabla users: ".concat(t.message,"\n"):l+="� Usuarios estudiantes: ".concat((null==a?void 0:a.length)||0,"\n")+"\uD83D\uDC64 Total usuarios (incluyendo admin): ".concat((null==s?void 0:s.length)||0,"\n"),a&&a.length>0){l+="\n\uD83D\uDCCB Por grupos:\n";for(let e=1;e<=5;e++){let t=a.filter(a=>a.group===e);l+="• Grupo ".concat(e,": ").concat(t.length," estudiantes\n")}}alert(l)}catch(e){console.error("❌ Error al verificar estudiantes:",e),alert("❌ Error: ".concat(e.message))}finally{h(!1)}};return g?(0,s.jsx)("div",{className:"glass p-8 rounded-2xl",children:(0,s.jsxs)("div",{className:"flex items-center justify-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 border-4 border-blue-500/30 border-t-blue-500 rounded-full animate-spin"}),(0,s.jsx)("span",{className:"ml-3 text-gray-400",children:"Cargando panel de administracion..."})]})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"glass p-4 rounded-2xl border-l-4 border-red-500",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-red-300 mb-1",children:"\uD83D\uDEA8 Restauraci\xf3n de Emergencia"}),(0,s.jsx)("p",{className:"text-gray-400 text-sm",children:"Restaurar rol de administrador para admin@admin.com (UUID: 2545304c-b9c2-4d8d-a413-93dad3f38007)"})]}),(0,s.jsx)("button",{onClick:es,className:"bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded-lg font-medium transition-colors duration-200 whitespace-nowrap",children:"\uD83D\uDD27 Restaurar Admin"})]})}),f&&(0,s.jsxs)("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("span",{className:"text-red-400 mr-3",children:"⚠️"}),(0,s.jsx)("span",{className:"text-red-300",children:f})]}),(0,s.jsx)("button",{onClick:()=>v(null),className:"text-red-400 hover:text-red-300 text-xl",children:"\xd7"})]}),(0,s.jsxs)("div",{className:"glass p-6 rounded-2xl",children:[(0,s.jsxs)("div",{className:"mb-4 flex gap-4",children:[(0,s.jsx)("button",{onClick:$,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium shadow",children:"\uD83E\uDDEA Probar Backup Manual"}),(0,s.jsx)("button",{onClick:q,className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg font-medium shadow",children:"\uD83E\uDDEA Probar Log en Supabase"})]}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-white mb-4",children:"Panel de Administracion"}),(0,s.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl",children:[(0,s.jsx)("h3",{className:"text-white font-semibold",children:"Total Usuarios"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-blue-400",children:a.length})]}),(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl",children:[(0,s.jsx)("h3",{className:"text-white font-semibold",children:"Delegados"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-green-400",children:a.filter(e=>"delegado"===e.data.role).length})]}),(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl",children:[(0,s.jsx)("h3",{className:"text-white font-semibold",children:"Administradores"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-purple-400",children:a.filter(e=>"admin"===e.data.role).length})]})]})]}),(0,s.jsxs)("div",{className:"glass p-6 rounded-2xl",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Crear Delegado"}),(0,s.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-400 mb-2",children:"Email"}),(0,s.jsx)("input",{type:"email",value:j,onChange:e=>N(e.target.value),placeholder:"delegado@email.com",className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-400 mb-2",children:"Grupo"}),(0,s.jsx)("select",{value:D,onChange:e=>y(Number(e.target.value)),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[1,2,3,4,5].map(e=>(0,s.jsxs)("option",{value:e,className:"bg-gray-800",children:["Grupo ",e]},e))})]}),(0,s.jsx)("div",{className:"flex items-end",children:(0,s.jsx)("button",{onClick:ea,disabled:w,className:"w-full bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 disabled:opacity-50 text-white px-6 py-3 rounded-xl font-medium transition-all duration-300",children:w?"Creando...":"Crear Delegado"})})]})]}),(0,s.jsxs)("div",{className:"glass p-6 rounded-2xl",children:[(0,s.jsxs)("div",{className:"flex space-x-1 mb-6 bg-white/5 rounded-xl p-1",children:[(0,s.jsx)("button",{onClick:()=>S("production"),className:"flex-1 py-3 px-4 rounded-lg font-medium transition-all duration-200 ".concat("production"===C?"bg-blue-500 text-white shadow-lg":"text-gray-400 hover:text-white hover:bg-white/10"),children:"\uD83D\uDE80 Producci\xf3n"}),(0,s.jsx)("button",{onClick:()=>S("launch"),className:"flex-1 py-3 px-4 rounded-lg font-medium transition-all duration-200 ".concat("launch"===C?"bg-red-500 text-white shadow-lg":"text-gray-400 hover:text-white hover:bg-white/10"),children:"\uD83D\uDDD1️ Lanzamiento"}),(0,s.jsx)("button",{onClick:()=>S("users"),className:"flex-1 py-3 px-4 rounded-lg font-medium transition-all duration-200 ".concat("users"===C?"bg-blue-500 text-white shadow-lg":"text-gray-400 hover:text-white hover:bg-white/10"),children:"\uD83D\uDC65 Usuarios"}),(0,s.jsx)("button",{onClick:()=>S("backups"),className:"flex-1 py-3 px-4 rounded-lg font-medium transition-all duration-200 ".concat("backups"===C?"bg-blue-500 text-white shadow-lg":"text-gray-400 hover:text-white hover:bg-white/10"),children:"\uD83D\uDCBE Backups"}),(0,s.jsx)("button",{onClick:()=>S("notifications"),className:"flex-1 py-3 px-4 rounded-lg font-medium transition-all duration-200 ".concat("notifications"===C?"bg-blue-500 text-white shadow-lg":"text-gray-400 hover:text-white hover:bg-white/10"),children:"\uD83D\uDD14 Notificaciones"}),(0,s.jsx)("button",{onClick:()=>S("logs"),className:"flex-1 py-3 px-4 rounded-lg font-medium transition-all duration-200 ".concat("logs"===C?"bg-blue-500 text-white shadow-lg":"text-gray-400 hover:text-white hover:bg-white/10"),children:"\uD83D\uDCCB Logs"}),(0,s.jsx)("button",{onClick:()=>S("system"),className:"flex-1 py-3 px-4 rounded-lg font-medium transition-all duration-200 ".concat("system"===C?"bg-blue-500 text-white shadow-lg":"text-gray-400 hover:text-white hover:bg-white/10"),children:"⚙️ Sistema"}),(0,s.jsx)("button",{onClick:()=>S("security"),className:"flex-1 py-3 px-4 rounded-lg font-medium transition-all duration-200 ".concat("security"===C?"bg-blue-500 text-white shadow-lg":"text-gray-400 hover:text-white hover:bg-white/10"),children:"\uD83D\uDD12 Seguridad"})]}),"production"===C&&(0,s.jsx)("div",{children:(0,s.jsx)(x,{})}),"users"===C&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("h3",{className:"text-xl font-semibold text-white",children:["Usuarios (",a.length,")"]}),(0,s.jsx)("button",{onClick:()=>X(),disabled:g,className:"px-4 py-2 rounded-lg transition-colors ".concat(g?"bg-gray-500/20 text-gray-400 cursor-not-allowed":"bg-blue-500/20 text-blue-400 hover:bg-blue-500/30"),title:"Recargar lista de usuarios",children:g?"\uD83D\uDD04 Cargando...":"\uD83D\uDD04 Recargar"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[a.map(e=>(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(i.Z,{user:{id:e.id,email:e.data.email,displayName:e.data.email||e.id},role:e.data.role,size:"md",showRole:!0}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-white",children:e.data.email||e.id}),(0,s.jsxs)("div",{className:"text-sm text-gray-400",children:[(0,n.UJ)(e.data.role),e.data.group&&" - Grupo ".concat(e.data.group)]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("select",{value:e.data.role,onChange:a=>et(e.id,a.target.value,e.data.group),className:"px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white text-sm",children:[(0,s.jsx)("option",{value:"usuario",className:"bg-gray-800",children:"Estudiante"}),(0,s.jsx)("option",{value:"delegado",className:"bg-gray-800",children:"Delegado"}),(0,s.jsx)("option",{value:"admin",className:"bg-gray-800",children:"Admin"})]}),"delegado"===e.data.role&&(0,s.jsx)("select",{value:e.data.group||1,onChange:a=>et(e.id,e.data.role,Number(a.target.value)),className:"px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white text-sm",children:[1,2,3,4,5].map(e=>(0,s.jsxs)("option",{value:e,className:"bg-gray-800",children:["Grupo ",e]},e))}),(0,s.jsx)("button",{onClick:()=>ee(e.id),className:"text-blue-400 hover:text-blue-300 px-3 py-2 rounded-lg hover:bg-blue-500/10 transition-colors",title:"Exportar datos GDPR",children:"\uD83D\uDCCB"}),(0,s.jsx)("button",{onClick:()=>er(e.id),disabled:p===e.id,className:"px-3 py-2 rounded-lg transition-colors ".concat(p===e.id?"text-gray-500 bg-gray-500/10 cursor-not-allowed":"text-red-400 hover:text-red-300 hover:bg-red-500/10"),title:p===e.id?"Eliminando...":"Eliminar usuario",children:p===e.id?"⏳":"\uD83D\uDDD1️"})]})]},e.id)),0===a.length&&(0,s.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No hay usuarios registrados"})]})]}),"backups"===C&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-semibold mb-4 text-white",children:"\uD83D\uDCBE Sistema de Backups"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-white",children:"Estado del Sistema"}),(0,s.jsx)("button",{onClick:async()=>{try{await _(),alert("✅ Estado actualizado")}catch(e){console.error("Error:",e),alert("❌ Error al actualizar estado")}},disabled:U,className:"text-blue-400 hover:text-blue-300 px-3 py-2 rounded-lg hover:bg-blue-500/10 transition-colors disabled:opacity-50",children:"\uD83D\uDD04 Actualizar"})]}),(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-400",children:"\xdaltimo backup:"}),(0,s.jsx)("div",{className:"text-white font-medium",children:z?new Date(z).toLocaleString("es-ES"):"No disponible"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Estado:"}),(0,s.jsx)("div",{className:"text-green-400 font-medium",children:"Sistema operativo"})]})]})]}),(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl",children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-white mb-3",children:"Acciones"}),(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,s.jsx)("button",{onClick:async()=>{try{let a=await O();if(a.success){var e;alert("✅ Backup creado exitosamente! Registros: ".concat((null===(e=a.data)||void 0===e?void 0:e.records)||"N/A")),await _()}else alert("❌ Error al crear backup: ".concat(a.error))}catch(e){console.error("Error:",e),alert("❌ Error al crear backup")}},disabled:U,className:"bg-green-600 hover:bg-green-700 disabled:opacity-50 text-white p-4 rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:U?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Creando Backup..."]}):(0,s.jsx)(s.Fragment,{children:"\uD83D\uDCBE Crear Backup Manual"})}),(0,s.jsx)("button",{onClick:()=>alert("Funcionalidad de programaci\xf3n autom\xe1tica disponible pr\xf3ximamente"),className:"bg-blue-600 hover:bg-blue-700 text-white p-4 rounded-lg font-medium transition-colors",children:"⏰ Programar Backups"})]})]}),(0,s.jsxs)("div",{className:"bg-blue-600/10 border border-blue-500/30 rounded-xl p-4",children:[(0,s.jsx)("h4",{className:"text-blue-300 font-medium mb-2",children:"\uD83D\uDCC5 Informaci\xf3n de Backups"}),(0,s.jsx)("p",{className:"text-gray-300 text-sm",children:"Los backups se crean autom\xe1ticamente cada 24 horas. Incluyen todos los datos cr\xedticos: usuarios, publicaciones, comentarios, ensayos y configuraciones de grupo."})]}),(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-white",children:"Historial de Backups"}),(0,s.jsxs)("span",{className:"text-sm text-gray-400",children:[T.length," backup",1!==T.length?"s":""," disponible",1!==T.length?"s":""]})]}),(0,s.jsx)("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:T.length>0?T.map(e=>(0,s.jsx)("div",{className:"p-3 rounded-lg border transition-colors ".concat("completed"===e.status?"bg-green-500/10 border-green-500/30":"bg-red-500/10 border-red-500/30"),children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("span",{className:"text-white font-medium",children:e.file_name}),(0,s.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat("completed"===e.status?"bg-green-600 text-green-100":"bg-red-600 text-red-100"),children:"completed"===e.status?"✅ Exitoso":"❌ Fallido"}),(0,s.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat("manual"===e.type?"bg-blue-600 text-blue-100":"bg-purple-600 text-purple-100"),children:"manual"===e.type?"\uD83D\uDDB1️ Manual":"⏰ Autom\xe1tico"})]}),(0,s.jsxs)("div",{className:"text-sm text-gray-400 space-y-1",children:[(0,s.jsxs)("div",{children:["\uD83D\uDCCA Registros: ",e.records_count.toLocaleString()]}),(0,s.jsxs)("div",{children:["\uD83D\uDD52 Creado: ",new Date(e.created_at).toLocaleString("es-ES")]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:["completed"===e.status&&(0,s.jsx)("button",{onClick:async()=>{if(confirm('\xbfEst\xe1s seguro de que quieres cargar el backup "'.concat(e.file_name,'"?\n\nEsto podr\xeda afectar los datos actuales.')))try{let s=await I(e.id);if(s.success){var a,t;alert("✅ Backup cargado exitosamente!\n\nArchivo: ".concat(null===(a=s.data)||void 0===a?void 0:a.fileName,"\nRegistros: ").concat(null===(t=s.data)||void 0===t?void 0:t.records))}else alert("❌ Error al cargar backup: ".concat(s.error))}catch(e){console.error("Error:",e),alert("❌ Error al cargar backup")}},disabled:U,className:"text-blue-400 hover:text-blue-300 px-3 py-1 rounded hover:bg-blue-500/10 transition-colors text-sm disabled:opacity-50",title:"Cargar backup",children:"\uD83D\uDCC2 Cargar"}),(0,s.jsx)("button",{onClick:()=>{confirm('\xbfEst\xe1s seguro de que quieres eliminar el backup "'.concat(e.file_name,'"?'))&&(B(e.id),alert("✅ Backup eliminado del historial"))},className:"text-red-400 hover:text-red-300 px-3 py-1 rounded hover:bg-red-500/10 transition-colors text-sm",title:"Eliminar del historial",children:"\uD83D\uDDD1️"})]})]})},e.id)):(0,s.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,s.jsx)("div",{className:"text-4xl mb-2",children:"\uD83D\uDCBE"}),(0,s.jsx)("div",{children:"No hay backups en el historial"}),(0,s.jsx)("div",{className:"text-sm mt-1",children:"Crea tu primer backup manual"})]})})]})]})]}),"notifications"===C&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-semibold mb-4 text-white",children:"\uD83D\uDD14 Centro de Notificaciones"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl",children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-white mb-3",children:"Crear Notificaci\xf3n"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("input",{type:"text",placeholder:"T\xedtulo de la notificaci\xf3n",value:k,onChange:e=>A(e.target.value),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,s.jsx)("textarea",{placeholder:"Mensaje de la notificaci\xf3n",value:L,onChange:e=>R(e.target.value),rows:3,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{onClick:async()=>{if(!k.trim()||!L.trim()){alert("Por favor completa el t\xedtulo y mensaje");return}try{await V((null==e?void 0:e.id)||"admin","system",k,L)?(alert("✅ Notificaci\xf3n creada exitosamente"),A(""),R("")):alert("❌ Error al crear notificaci\xf3n")}catch(e){console.error("Error:",e),alert("❌ Error al crear notificaci\xf3n")}},className:"bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-xl font-medium transition-colors",children:"\uD83D\uDCE2 Crear Notificaci\xf3n"}),(0,s.jsx)("button",{onClick:()=>{let e=H();alert("\uD83D\uDCCA Estad\xedsticas de Notificaciones:\n\n• Total: ".concat(e.total,"\n• No le\xeddas: ").concat(e.unread,"\n• Le\xeddas: ").concat(e.read,"\n\nPor tipo:\n• Sistema: ").concat(e.byType.system,"\n• Comentarios: ").concat(e.byType.comment,"\n• Posts: ").concat(e.byType.post_published,"\n• Ensayos: ").concat(e.byType.essay_uploaded,"\n• Menciones: ").concat(e.byType.mention))},className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl font-medium transition-colors",children:"\uD83D\uDCCA Ver Estad\xedsticas"}),(0,s.jsx)("button",{onClick:()=>{W(),alert("✅ Notificaciones expiradas eliminadas")},className:"bg-orange-600 hover:bg-orange-700 text-white px-6 py-3 rounded-xl font-medium transition-colors",children:"\uD83E\uDDF9 Limpiar Expiradas"})]})]})]}),(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-white",children:"Notificaciones Recientes"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:F,className:"text-blue-400 hover:text-blue-300 px-3 py-2 rounded-lg hover:bg-blue-500/10 transition-colors text-sm",children:"✓ Marcar todo como le\xeddo"}),(0,s.jsx)("button",{onClick:()=>{confirm("\xbfEst\xe1s seguro de que quieres eliminar todas las notificaciones?")&&J()},className:"text-red-400 hover:text-red-300 px-3 py-2 rounded-lg hover:bg-red-500/10 transition-colors text-sm",children:"\uD83D\uDDD1️ Eliminar todas"})]})]}),(0,s.jsx)("div",{className:"space-y-3",children:P.length>0?P.slice(0,5).map(e=>(0,s.jsx)("div",{className:"p-3 rounded-lg border ".concat(e.read?"bg-white/5 border-white/10":"bg-blue-500/10 border-blue-500/30"),children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"text-white font-medium",children:e.title}),(0,s.jsx)("div",{className:"text-gray-400 text-sm mt-1",children:e.message}),(0,s.jsx)("div",{className:"text-gray-500 text-xs mt-1",children:new Date(e.created_at).toLocaleString("es-ES")})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 ml-3",children:[!e.read&&(0,s.jsx)("button",{onClick:()=>M(e.id),className:"text-blue-400 hover:text-blue-300 text-sm px-2 py-1 rounded hover:bg-blue-500/10 transition-colors",title:"Marcar como le\xedda",children:"✓"}),(0,s.jsx)("button",{onClick:()=>{confirm("\xbfEliminar esta notificaci\xf3n?")&&G(e.id)},className:"text-red-400 hover:text-red-300 text-sm px-2 py-1 rounded hover:bg-red-500/10 transition-colors",title:"Eliminar notificaci\xf3n",children:"\uD83D\uDDD1️"})]})]})},e.id)):(0,s.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No hay notificaciones"})})]})]})]}),"logs"===C&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-semibold mb-4 text-white",children:"\uD83D\uDCCB Logs del Sistema"}),(0,s.jsx)("div",{className:"grid md:grid-cols-4 gap-4 mb-6",children:(()=>{let e=Z();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl",children:[(0,s.jsx)("h4",{className:"text-white font-semibold",children:"Total de Logs"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-blue-400",children:e.total})]}),(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl",children:[(0,s.jsx)("h4",{className:"text-white font-semibold",children:"Hoy"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-green-400",children:e.today})]}),(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl",children:[(0,s.jsx)("h4",{className:"text-white font-semibold",children:"Esta Semana"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-yellow-400",children:e.thisWeek})]}),(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl",children:[(0,s.jsx)("h4",{className:"text-white font-semibold",children:"Errores"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-red-400",children:e.errors})]})]})})()}),(0,s.jsx)("div",{className:"bg-white/5 p-4 rounded-xl mb-6",children:(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{onClick:()=>{let e=Z();alert("\uD83D\uDCCA Estad\xedsticas Detalladas de Logs:\n\n• Total: ".concat(e.total,"\n• Hoy: ").concat(e.today,"\n• Esta semana: ").concat(e.thisWeek,"\n• Errores: ").concat(e.errors,"\n\nPor nivel:\n• Info: ").concat(e.byLevel.info,"\n• Warning: ").concat(e.byLevel.warning,"\n• Error: ").concat(e.byLevel.error,"\n• Critical: ").concat(e.byLevel.critical))},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",children:"\uD83D\uDCCA Ver Estad\xedsticas"}),(0,s.jsx)("button",{onClick:()=>{Q(),alert("✅ Logs exportados correctamente")},className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors",children:"\uD83D\uDCBE Exportar Logs"}),(0,s.jsx)("button",{onClick:()=>{confirm("\xbfEst\xe1s seguro de que quieres limpiar todos los logs? Esta acci\xf3n no se puede deshacer.")&&(K(),alert("✅ Logs limpiados correctamente"))},className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors",children:"\uD83D\uDDD1️ Limpiar Logs"})]})}),(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl",children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-white mb-3",children:"Logs Recientes (\xfaltimos 20)"}),(0,s.jsxs)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[Y({limit:20}).map(e=>(0,s.jsxs)("div",{className:"p-3 rounded-lg border text-sm ".concat("critical"===e.level?"bg-red-500/20 border-red-500/50":"error"===e.level?"bg-red-500/10 border-red-500/30":"warning"===e.level?"bg-yellow-500/10 border-yellow-500/30":"bg-white/5 border-white/10"),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,s.jsx)("span",{className:"font-medium ".concat("critical"===e.level?"text-red-300":"error"===e.level?"text-red-400":"warning"===e.level?"text-yellow-400":"text-blue-400"),children:e.action.replace(/_/g," ").toUpperCase()}),(0,s.jsx)("span",{className:"text-gray-400 text-xs",children:new Date(e.timestamp).toLocaleString("es-ES")})]}),(0,s.jsxs)("div",{className:"text-gray-300",children:["Usuario: ",e.user_email||e.user_id]}),Object.keys(e.details).length>0&&(0,s.jsxs)("div",{className:"text-gray-400 text-xs mt-1",children:["Detalles: ",JSON.stringify(e.details)]})]},e.id)),0===Y({limit:20}).length&&(0,s.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No hay logs registrados"})]})]})]}),"system"===C&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-semibold mb-4 text-white",children:"⚙️ Estado del Sistema"}),(0,s.jsxs)("div",{className:"grid md:grid-cols-4 gap-4 mb-6",children:[(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl",children:[(0,s.jsx)("h4",{className:"text-white font-semibold",children:"Estado General"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-green-400",children:"\uD83D\uDFE2 Operativo"})]}),(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl",children:[(0,s.jsx)("h4",{className:"text-white font-semibold",children:"Base de Datos"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-green-400",children:"\uD83D\uDFE2 Conectada"})]}),(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl",children:[(0,s.jsx)("h4",{className:"text-white font-semibold",children:"Almacenamiento"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-blue-400",children:"\uD83D\uDCBE Disponible"})]}),(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl",children:[(0,s.jsx)("h4",{className:"text-white font-semibold",children:"Seguridad"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-green-400",children:"\uD83D\uDEE1️ Activa"})]})]}),(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl mb-6",children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-white mb-3",children:"Monitoreo en Tiempo Real"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-gray-300",children:"Usuarios conectados"}),(0,s.jsxs)("span",{className:"text-green-400 font-medium",children:[a.length," usuarios"]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-gray-300",children:"\xdaltimo backup"}),(0,s.jsx)("span",{className:"text-blue-400 font-medium",children:z?new Date(z).toLocaleString("es-ES"):"No disponible"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-gray-300",children:"Logs registrados hoy"}),(0,s.jsxs)("span",{className:"text-yellow-400 font-medium",children:[Z().today," logs"]})]})]})]}),(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl",children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-white mb-3",children:"Acciones del Sistema"}),(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,s.jsx)("button",{onClick:()=>{O(),alert("✅ Backup iniciado")},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg transition-colors",children:"\uD83D\uDCBE Crear Backup Inmediato"}),(0,s.jsx)("button",{onClick:()=>{W(),alert("✅ Limpieza completada")},className:"bg-orange-600 hover:bg-orange-700 text-white px-4 py-3 rounded-lg transition-colors",children:"\uD83E\uDDF9 Limpiar Sistema"}),(0,s.jsx)("button",{onClick:()=>{X(),_(),alert("✅ Sistema actualizado")},className:"bg-green-600 hover:bg-green-700 text-white px-4 py-3 rounded-lg transition-colors",children:"\uD83D\uDD04 Actualizar Todo"}),(0,s.jsx)("button",{onClick:()=>{let e=Z();alert("\uD83D\uDCCA Estado del Sistema:\n\n• Usuarios: ".concat(a.length,"\n• \xdaltimo backup: ").concat(z?new Date(z).toLocaleString("es-ES"):"No disponible","\n• Logs hoy: ").concat(e.today,"\n• Total logs: ").concat(e.total,"\n• Errores: ").concat(e.errors))},className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-3 rounded-lg transition-colors",children:"\uD83D\uDCCA Ver Reporte Completo"})]})]})]}),"security"===C&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-semibold mb-4 text-white",children:"� Gesti\xf3n de Seguridad"}),(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl mb-6",children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-white mb-3",children:"Rate Limiting"}),(0,s.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"bg-green-500/10 border border-green-500/30 p-3 rounded-lg",children:[(0,s.jsx)("div",{className:"text-green-400 font-medium",children:"Posts"}),(0,s.jsx)("div",{className:"text-green-300 text-sm",children:"L\xedmite: 10 por hora"}),(0,s.jsx)("div",{className:"text-green-400 text-xs",children:"Estado: ✅ Activo"})]}),(0,s.jsxs)("div",{className:"bg-blue-500/10 border border-blue-500/30 p-3 rounded-lg",children:[(0,s.jsx)("div",{className:"text-blue-400 font-medium",children:"Comentarios"}),(0,s.jsx)("div",{className:"text-blue-300 text-sm",children:"L\xedmite: 20 por hora"}),(0,s.jsx)("div",{className:"text-blue-400 text-xs",children:"Estado: ✅ Activo"})]}),(0,s.jsxs)("div",{className:"bg-purple-500/10 border border-purple-500/30 p-3 rounded-lg",children:[(0,s.jsx)("div",{className:"text-purple-400 font-medium",children:"Login"}),(0,s.jsx)("div",{className:"text-purple-300 text-sm",children:"L\xedmite: 5 por minuto"}),(0,s.jsx)("div",{className:"text-purple-400 text-xs",children:"Estado: ✅ Activo"})]})]})]}),(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl mb-6",children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-white mb-3",children:"Resumen de Auditor\xeda"}),(0,s.jsx)("div",{className:"grid md:grid-cols-4 gap-4",children:(()=>{let e=Z();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-400",children:e.total}),(0,s.jsx)("div",{className:"text-gray-400 text-sm",children:"Total de eventos"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-green-400",children:e.today}),(0,s.jsx)("div",{className:"text-gray-400 text-sm",children:"Eventos hoy"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-yellow-400",children:e.byLevel.warning}),(0,s.jsx)("div",{className:"text-gray-400 text-sm",children:"Advertencias"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-red-400",children:e.errors}),(0,s.jsx)("div",{className:"text-gray-400 text-sm",children:"Errores cr\xedticos"})]})]})})()})]}),(0,s.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl",children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-white mb-3",children:"Acciones de Seguridad"}),(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,s.jsx)("button",{onClick:()=>{let e=Z();alert("\uD83D\uDD12 Reporte de Seguridad:\n\n• Total de eventos: ".concat(e.total,"\n• Eventos hoy: ").concat(e.today,"\n• Advertencias: ").concat(e.byLevel.warning,"\n• Errores: ").concat(e.errors,"\n• Eventos cr\xedticos: ").concat(e.byLevel.critical,"\n\n✅ Rate limiting activo\n✅ Audit logging funcional\n✅ Backups autom\xe1ticos"))},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg transition-colors",children:"\uD83D\uDEE1️ Reporte de Seguridad"}),(0,s.jsx)("button",{onClick:()=>{Q(),alert("✅ Logs de seguridad exportados")},className:"bg-green-600 hover:bg-green-700 text-white px-4 py-3 rounded-lg transition-colors",children:"\uD83D\uDCCB Exportar Logs de Seguridad"}),(0,s.jsx)("button",{onClick:()=>{confirm("\xbfBloquear temporalmente nuevos registros? Esto evitar\xe1 que se creen nuevas cuentas durante 1 hora.")&&alert("\uD83D\uDEAB Registros bloqueados temporalmente")},className:"bg-orange-600 hover:bg-orange-700 text-white px-4 py-3 rounded-lg transition-colors",children:"\uD83D\uDEAB Bloquear Registros"}),(0,s.jsx)("button",{onClick:()=>{confirm("\xbfLimpiar todos los logs de m\xe1s de 30 d\xedas?")&&alert("\uD83E\uDDF9 Logs antiguos eliminados")},className:"bg-red-600 hover:bg-red-700 text-white px-4 py-3 rounded-lg transition-colors",children:"\uD83D\uDDD1️ Limpiar Logs Antiguos"})]})]})]}),"launch"===C&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-semibold mb-4 text-white",children:"\uD83D\uDE80 Preparaci\xf3n para Lanzamiento"}),(0,s.jsxs)("div",{className:"bg-red-500/10 border border-red-500/30 p-6 rounded-xl mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center mb-4",children:[(0,s.jsx)("span",{className:"text-red-400 text-2xl mr-3",children:"⚠️"}),(0,s.jsx)("h4",{className:"text-lg font-bold text-red-300",children:"ZONA DE PELIGRO"})]}),(0,s.jsxs)("p",{className:"text-red-200 mb-6",children:["Las siguientes acciones son ",(0,s.jsx)("strong",{children:"IRREVERSIBLES"})," y est\xe1n dise\xf1adas para limpiar completamente la plataforma antes del lanzamiento oficial."]}),(0,s.jsxs)("div",{className:"grid gap-4",children:[(0,s.jsxs)("div",{className:"bg-black/20 p-4 rounded-lg border border-red-500/20",children:[(0,s.jsx)("h5",{className:"text-white font-semibold mb-2",children:"\uD83D\uDDD1️ Borrar Todo el Contenido"}),(0,s.jsx)("p",{className:"text-gray-300 text-sm mb-4",children:"Elimina todos los posts, comentarios, archivos subidos y datos de personalizaci\xf3n de grupos."}),(0,s.jsx)("button",{onClick:el,disabled:g,className:"px-6 py-3 rounded-lg font-medium transition-all ".concat(g?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-red-600 hover:bg-red-700 text-white hover:scale-105 shadow-lg"),children:g?(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Procesando..."]}):"\uD83D\uDDD1️ BORRAR TODO EL CONTENIDO"})]}),(0,s.jsxs)("div",{className:"bg-black/20 p-4 rounded-lg border border-blue-500/20",children:[(0,s.jsx)("h5",{className:"text-white font-semibold mb-2",children:"\uD83D\uDD27 Arreglar Nombres de Autores"}),(0,s.jsx)("p",{className:"text-gray-300 text-sm mb-4",children:"Actualiza los nombres de autores en posts y comentarios existentes para mostrar nombres legibles en lugar de IDs."}),(0,s.jsx)("button",{onClick:ei,disabled:g,className:"px-6 py-3 rounded-lg font-medium transition-all ".concat(g?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white hover:scale-105 shadow-lg"),children:g?(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Procesando..."]}):"\uD83D\uDD27 ARREGLAR NOMBRES DE AUTORES"})]}),(0,s.jsxs)("div",{className:"bg-black/20 p-4 rounded-lg border border-green-500/20",children:[(0,s.jsx)("h5",{className:"text-white font-semibold mb-2",children:"\uD83D\uDC65 Actualizar Integrantes de Grupos"}),(0,s.jsx)("p",{className:"text-gray-300 text-sm mb-4",children:"Reemplaza la base de datos de estudiantes con la nueva lista de integrantes de grupos proporcionada."}),(0,s.jsx)("button",{onClick:en,disabled:g,className:"px-6 py-3 rounded-lg font-medium transition-all ".concat(g?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white hover:scale-105 shadow-lg"),children:g?(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Procesando..."]}):"\uD83D\uDC65 ACTUALIZAR INTEGRANTES GRUPOS"})]}),(0,s.jsxs)("div",{className:"bg-black/20 p-4 rounded-lg border border-blue-500/20",children:[(0,s.jsx)("h5",{className:"text-white font-semibold mb-2",children:"\uD83D\uDD0D Verificar Estudiantes"}),(0,s.jsx)("p",{className:"text-gray-300 text-sm mb-4",children:"Verifica que los estudiantes se hayan cargado correctamente en la base de datos."}),(0,s.jsx)("button",{onClick:ed,disabled:g,className:"px-6 py-3 rounded-lg font-medium transition-all ".concat(g?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white hover:scale-105 shadow-lg"),children:g?(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Verificando..."]}):"\uD83D\uDD0D VERIFICAR ESTUDIANTES"})]}),(0,s.jsxs)("div",{className:"bg-black/20 p-4 rounded-lg border border-orange-500/20",children:[(0,s.jsx)("h5",{className:"text-white font-semibold mb-2",children:"\uD83D\uDC65 Borrar Usuarios de Prueba"}),(0,s.jsx)("p",{className:"text-gray-300 text-sm mb-4",children:"Elimina todos los usuarios excepto administradores. \xdatil para limpiar cuentas de prueba."}),(0,s.jsx)("button",{onClick:eo,disabled:g,className:"px-6 py-3 rounded-lg font-medium transition-all ".concat(g?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-orange-600 hover:bg-orange-700 text-white hover:scale-105 shadow-lg"),children:g?(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Procesando..."]}):"\uD83D\uDC65 BORRAR USUARIOS NO-ADMIN"})]}),(0,s.jsxs)("div",{className:"bg-green-500/10 border border-green-500/30 p-4 rounded-lg",children:[(0,s.jsx)("h5",{className:"text-green-300 font-semibold mb-2",children:"✅ Lista de Verificaci\xf3n de Lanzamiento"}),(0,s.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center text-green-200",children:[(0,s.jsx)("span",{className:"mr-2",children:"✅"})," Footer actualizado con branding ROBUX"]}),(0,s.jsxs)("div",{className:"flex items-center text-green-200",children:[(0,s.jsx)("span",{className:"mr-2",children:"✅"})," Subida de im\xe1genes funcionando correctamente"]}),(0,s.jsxs)("div",{className:"flex items-center text-green-200",children:[(0,s.jsx)("span",{className:"mr-2",children:"✅"})," Animaciones optimizadas"]}),(0,s.jsxs)("div",{className:"flex items-center text-yellow-200",children:[(0,s.jsx)("span",{className:"mr-2",children:"⚠️"})," Contenido de prueba pendiente de limpieza"]})]})]})]})]}),(0,s.jsxs)("div",{className:"bg-blue-500/10 border border-blue-500/30 p-4 rounded-xl",children:[(0,s.jsx)("h4",{className:"text-blue-300 font-semibold mb-2",children:"\uD83D\uDCCB Notas para el Lanzamiento"}),(0,s.jsxs)("ul",{className:"text-blue-200 text-sm space-y-1",children:[(0,s.jsx)("li",{children:"• Aseg\xfarate de hacer un backup antes de borrar contenido"}),(0,s.jsx)("li",{children:"• Verifica que los buckets de Supabase Storage est\xe9n correctamente configurados"}),(0,s.jsx)("li",{children:"• Confirma que las pol\xedticas RLS est\xe9n activas"}),(0,s.jsx)("li",{children:"• Prueba la creaci\xf3n de nuevos usuarios despu\xe9s de la limpieza"})]})]})]})]})]})}function h(){return(0,s.jsx)("div",{className:"p-4 md:p-8",children:(0,s.jsx)(g,{})})}},5506:function(e,a,t){"use strict";t.d(a,{RC:function(){return o}});var s=t(1180),r=t(3259);class l{static getInstance(){return l.instance||(l.instance=new l),l.instance}setUser(e){this.user=e}loadLogsFromStorage(){try{let e=window.localStorage.getItem("audit_logs");e&&(this.logs=JSON.parse(e))}catch(e){console.error("Error loading logs from storage:",e)}}saveLogsToStorage(){try{let e=this.logs.slice(-1e3);window.localStorage.setItem("audit_logs",JSON.stringify(e)),this.logs=e}catch(e){console.error("Error saving logs to storage:",e)}}async log(e){var a,t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o={id:crypto.randomUUID(),timestamp:new Date().toISOString(),user_id:(null===(a=this.user)||void 0===a?void 0:a.id)||"anonymous",user_email:(null===(t=this.user)||void 0===t?void 0:t.email)||"unknown",action:e,level:r,details:l,ip_address:"local",user_agent:navigator.userAgent};this.logs.push(o),this.saveLogsToStorage();try{let e=(0,s.S)();await e.from("logs").insert({id:o.id,timestamp:o.timestamp,user_id:o.user_id,user_email:o.user_email,action:o.action,level:o.level,details:o.details,ip_address:o.ip_address,user_agent:o.user_agent})}catch(e){console.warn("No se pudo guardar el log en Supabase:",e)}("critical"===r||"error"===r)&&console.error("[AUDIT ".concat(r.toUpperCase(),"]"),e,l)}getLogs(e){let a=[...this.logs];return(null==e?void 0:e.level)&&(a=a.filter(a=>a.level===e.level)),(null==e?void 0:e.action)&&(a=a.filter(a=>a.action===e.action)),(null==e?void 0:e.userId)&&(a=a.filter(a=>a.user_id===e.userId)),a.sort((e,a)=>new Date(a.timestamp).getTime()-new Date(e.timestamp).getTime()),(null==e?void 0:e.limit)&&(a=a.slice(0,e.limit)),a}getStats(){let e=new Date,a=new Date(e.getFullYear(),e.getMonth(),e.getDate()),t=new Date(e.getTime()-6048e5);return{total:this.logs.length,today:this.logs.filter(e=>new Date(e.timestamp)>=a).length,thisWeek:this.logs.filter(e=>new Date(e.timestamp)>=t).length,errors:this.logs.filter(e=>"error"===e.level||"critical"===e.level).length,byLevel:{info:this.logs.filter(e=>"info"===e.level).length,warning:this.logs.filter(e=>"warning"===e.level).length,error:this.logs.filter(e=>"error"===e.level).length,critical:this.logs.filter(e=>"critical"===e.level).length},byAction:this.logs.reduce((e,a)=>(e[a.action]=(e[a.action]||0)+1,e),{})}}clearLogs(){this.logs=[],window.localStorage.removeItem("audit_logs")}exportLogs(){let e=new Blob([JSON.stringify(this.logs,null,2)],{type:"application/json"}),a=URL.createObjectURL(e),t=document.createElement("a");t.href=a,t.download="audit_logs_".concat(new Date().toISOString().split("T")[0],".json"),document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(a)}constructor(){this.user=null,this.logs=[],this.loadLogsFromStorage()}}function o(){let{user:e}=(0,r.a)(),a=l.getInstance();return e&&a.setUser(e),{log:a.log.bind(a),getLogs:a.getLogs.bind(a),getStats:a.getStats.bind(a),clearLogs:a.clearLogs.bind(a),exportLogs:a.exportLogs.bind(a)}}a.ZP=l},5976:function(e,a,t){"use strict";t.d(a,{z:function(){return l}});var s=t(2265),r=t(3259);function l(){let[e,a]=(0,s.useState)([]),[t,l]=(0,s.useState)(0),[o,i]=(0,s.useState)(!0),{user:n}=(0,r.a)(),d=(0,s.useRef)(!1),c=(0,s.useCallback)(()=>{let e=(null==n?void 0:n.id)||(null==n?void 0:n.email)||"anonymous";return"notifications_".concat(e)},[null==n?void 0:n.id,null==n?void 0:n.email]),u=(0,s.useCallback)(e=>{try{localStorage.setItem(c(),JSON.stringify(e))}catch(e){console.error("Error guardando notificaciones:",e)}},[c]),m=(0,s.useCallback)(()=>{if(!d.current)try{let e=localStorage.getItem(c());if(e){let t=JSON.parse(e).filter(e=>new Date(e.expires_at)>new Date);a(t),l(t.filter(e=>!e.read).length)}else a([]),l(0)}catch(e){console.error("Error cargando notificaciones:",e),a([]),l(0)}finally{i(!1),d.current=!0}},[c]),x=(0,s.useCallback)(e=>{a(a=>{let t=a.filter(a=>a.id!==e);u(t);let s=a.find(a=>a.id===e);return s&&!s.read&&l(e=>Math.max(0,e-1)),t})},[u]),g=(0,s.useCallback)(()=>{a([]),l(0),localStorage.removeItem(c())},[c]),h=(0,s.useCallback)(e=>{a(a=>{let t=a.map(a=>a.id===e?{...a,read:!0}:a);u(t);let s=a.find(a=>a.id===e);return s&&!s.read&&l(e=>Math.max(0,e-1)),t})},[u]),p=(0,s.useCallback)(()=>{a(e=>{let a=e.map(e=>({...e,read:!0}));return u(a),l(0),a})},[u]),b=(0,s.useCallback)(function(e,t,s,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i={id:crypto.randomUUID(),user_id:e,type:t,title:s,message:r,data:o,read:!1,created_at:new Date().toISOString(),expires_at:new Date(Date.now()+2592e6).toISOString()};return a(e=>{let a=[i,...e].slice(0,50);return u(a),l(e=>e+1),a}),!0},[u]),f=(0,s.useCallback)(()=>{a(e=>{let a=e.filter(e=>new Date(e.expires_at)>new Date);return a.length!==e.length&&(u(a),l(a.filter(e=>!e.read).length)),a})},[u]),v=(0,s.useCallback)(a=>e.filter(e=>e.type===a),[e]),j=(0,s.useCallback)(()=>({total:e.length,unread:t,read:e.length-t,byType:{system:e.filter(e=>"system"===e.type).length,comment:e.filter(e=>"comment"===e.type).length,post_published:e.filter(e=>"post_published"===e.type).length,essay_uploaded:e.filter(e=>"essay_uploaded"===e.type).length,mention:e.filter(e=>"mention"===e.type).length}}),[e,t]),N=(0,s.useCallback)((e,t)=>(a(a=>{let s=a.map(a=>a.id===e?{...a,...t}:a);return u(s),s}),!0),[u]);return(0,s.useEffect)(()=>{n&&!d.current&&m()},[n,m]),{notifications:e,unreadCount:t,loading:o,markAsRead:h,markAllAsRead:p,deleteNotification:x,deleteAllNotifications:g,createNotification:b,editNotification:N,cleanExpiredNotifications:f,getNotificationsByType:v,getStats:j,refresh:m}}}},function(e){e.O(0,[835,320,971,23,744],function(){return e(e.s=3422)}),_N_E=e.O()}]);