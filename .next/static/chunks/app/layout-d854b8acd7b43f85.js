(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{3932:function(e,t,n){Promise.resolve().then(n.t.bind(n,8877,23)),Promise.resolve().then(n.bind(n,6425)),Promise.resolve().then(n.bind(n,7087)),Promise.resolve().then(n.bind(n,4042))},6425:function(e,t,n){"use strict";n.d(t,{default:function(){return h}});var s=n(7437),a=n(7138),r=n(6463),i=n(3259),l=n(1180),o=n(2265),c=n(6758),d=n(5976);let u=(0,o.memo)(function(e){let{className:t=""}=e,[n,a]=(0,o.useState)(!1),r=(0,o.useRef)(null),{notifications:i,unreadCount:l,loading:c,markAsRead:u,markAllAsRead:m}=(0,d.z)();(0,o.useEffect)(()=>{function e(e){r.current&&!r.current.contains(e.target)&&a(!1)}if(n)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[n]);let h=e=>{switch(e){case"comment":return"\uD83D\uDCAC";case"post_published":return"\uD83D\uDCDD";case"essay_uploaded":return"\uD83D\uDCC4";case"mention":return"\uD83D\uDC64";case"system":return"⚙️";default:return"\uD83D\uDD14"}},x=e=>{let t=Math.floor((new Date().getTime()-new Date(e).getTime())/6e4);return t<1?"Ahora":t<60?"".concat(t,"m"):t<1440?"".concat(Math.floor(t/60),"h"):"".concat(Math.floor(t/1440),"d")},p=e=>{e.read||u(e.id)};return c?(0,s.jsx)("div",{className:"relative ".concat(t),children:(0,s.jsx)("button",{className:"p-2 text-gray-400 hover:text-white transition-colors",children:(0,s.jsx)("div",{className:"animate-pulse w-6 h-6 bg-gray-600 rounded"})})}):(0,s.jsxs)("div",{className:"relative ".concat(t),ref:r,children:[(0,s.jsxs)("button",{onClick:()=>a(!n),className:"relative p-2 text-gray-400 hover:text-white transition-colors focus:outline-none","aria-label":"Notificaciones",children:["\uD83D\uDD14",l>0&&(0,s.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center animate-pulse",children:l>99?"99+":l})]}),n&&(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-80 backdrop-blur-xl bg-white/80 border border-blue-200 rounded-2xl shadow-2xl z-50 max-h-96 overflow-hidden",style:{boxShadow:"0 8px 32px rgba(59,130,246,0.12)",backdropFilter:"blur(16px)"},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Notificaciones"}),l>0&&(0,s.jsx)("button",{onClick:()=>{m(),a(!1)},className:"text-sm text-blue-400 hover:text-blue-300 transition-colors",children:"Marcar todas como le\xeddas"})]}),(0,s.jsx)("div",{className:"max-h-64 overflow-y-auto",children:0===i.length?(0,s.jsxs)("div",{className:"p-6 text-center text-gray-400",children:[(0,s.jsx)("div",{className:"text-4xl mb-2",children:"\uD83D\uDD14"}),(0,s.jsx)("p",{children:"No hay notificaciones"})]}):i.slice(0,10).map(e=>(0,s.jsx)("div",{onClick:()=>p(e),className:"p-4 border-b border-gray-700/50 cursor-pointer transition-colors hover:bg-gray-800/50 ".concat(e.read?"":"bg-blue-500/10"),children:(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,s.jsx)("span",{className:"text-2xl",children:h(e.type)}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-sm font-medium ".concat(e.read?"text-gray-300":"text-white"),children:e.title}),!e.read&&(0,s.jsx)("span",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0"})]}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1 line-clamp-2",children:e.message}),(0,s.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:x(e.created_at)})]})]})},e.id))}),i.length>0&&(0,s.jsx)("div",{className:"p-3 border-t border-gray-700 text-center",children:(0,s.jsx)("button",{onClick:()=>a(!1),className:"text-sm text-gray-400 hover:text-white transition-colors",children:i.length>10?"Ver todas las ".concat(i.length," notificaciones"):"Cerrar"})})]})]})}),m=[{id:1,name:"Grupo 1",topic:"Inteligencia Artificial y Machine Learning"},{id:2,name:"Grupo 2",topic:"Energ\xedas Renovables y Conservaci\xf3n"},{id:3,name:"Grupo 3",topic:"Telemedicina y Aplicaciones M\xe9dicas"},{id:4,name:"Grupo 4",topic:"Robux"},{id:5,name:"Grupo 5",topic:"Aplicaciones Descentralizadas y DeFi"}];function h(){let e=(0,r.usePathname)(),t=(0,r.useRouter)(),{user:n,role:d}=(0,i.a)(),[h,x]=(0,o.useState)(!1),p=(0,o.useCallback)(t=>!!("/"===t&&"/"===e||"/"!==t&&e.startsWith(t)),[e]),f=(0,o.useMemo)(()=>{let t=e.split("/").filter(Boolean),n=[];if(t.length>0)switch(t[0]){case"grupo":if(t[1]){let e=parseInt(t[1]),s=m.find(t=>t.id===e);s&&n.push({label:s.name,href:"/grupo/".concat(e),icon:""})}break;case"admin":n.push({label:"Administraci\xf3n",href:"/admin",icon:""});break;case"login":n.push({label:"Iniciar Sesi\xf3n",href:"/login",icon:""});break;case"perfil":n.push({label:"Perfil",href:"/perfil",icon:""})}return n},[e]),g=(0,o.useCallback)(async()=>{try{await (0,l.S)().auth.signOut(),t.push("/");let e=document.createElement("div");e.className="fixed top-4 right-4 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg z-50",e.textContent="Sesi\xf3n cerrada. Ahora eres un estudiante.",document.body.appendChild(e),setTimeout(()=>{document.body.contains(e)&&document.body.removeChild(e)},3e3)}catch(e){console.error("Error al cerrar sesi\xf3n:",e)}},[t]),v=(0,o.useCallback)(()=>{t.back()},[t]),b="/"!==e;return(0,s.jsx)("nav",{className:"sticky top-5 sm:top-6 z-50 px-4 navbar",children:(0,s.jsx)("div",{className:"nav-zonecraft max-w-7xl mx-auto rounded-2xl",children:(0,s.jsxs)("div",{className:"px-4 sm:px-6 lg:px-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 min-w-0",children:[b&&(0,s.jsx)("button",{onClick:v,className:"p-2 rounded-xl transition-all duration-200 nav-link-zonecraft",title:"Regresar",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,s.jsx)(a.default,{href:"/",className:"flex items-center space-x-3 group",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-400 to-blue-600 rounded-lg flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-white font-bold text-sm",children:"R"})}),(0,s.jsx)("h1",{className:"text-lg font-bold text-white",children:"ROBUX"})]})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[f.length>0&&(0,s.jsx)("div",{className:"hidden lg:flex items-center gap-2 px-3 py-2 zonecraft-glass rounded-xl",children:f.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[t>0&&(0,s.jsx)("span",{className:"text-xs text-white/50",children:"›"}),(0,s.jsx)("span",{className:"text-xs text-white/80 truncate max-w-32",children:e.label})]},e.href))}),("admin"===d||"delegado"===d)&&(0,s.jsxs)("div",{className:"hidden md:flex items-center gap-2",children:[(0,s.jsx)(a.default,{href:"/admin",children:(0,s.jsxs)("div",{className:"nav-link-zonecraft flex items-center gap-2 px-3 py-2 rounded-xl text-sm font-medium transition-all duration-200 ".concat(p("/admin")?"active":""),children:[(0,s.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,s.jsx)("span",{className:"hidden lg:inline",children:"Admin"})]})}),(0,s.jsx)(a.default,{href:"/perfil",children:(0,s.jsxs)("div",{className:"nav-link-zonecraft flex items-center gap-2 px-3 py-2 rounded-xl text-sm font-medium transition-all duration-200 ".concat(p("/perfil")?"active":""),children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),(0,s.jsx)("span",{className:"hidden lg:inline",children:"Perfil"})]})})]}),n&&(0,s.jsx)(u,{}),n?(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)(a.default,{href:"/perfil",className:"flex items-center gap-3 hover:opacity-80 transition-opacity",children:[(0,s.jsx)(c.Z,{user:n,role:d,size:"sm",showRole:!1}),(0,s.jsx)("div",{className:"hidden sm:block text-sm",children:(0,s.jsx)("div",{className:"font-medium truncate max-w-24 text-white",children:n.displayName||n.email||"Usuario"})})]}),"anonimo"===d?(0,s.jsx)(a.default,{href:"/login",children:(0,s.jsx)("div",{className:"zonecraft-button px-4 py-2 text-sm font-medium transition-all duration-200",children:"Login"})}):(0,s.jsx)("button",{onClick:g,className:"px-3 py-2 text-sm font-medium text-red-300 hover:text-red-200 bg-red-600/20 hover:bg-red-600/30 border border-red-500/40 rounded-xl transition-all duration-200",children:"Salir"})]}):null]})]}),f.length>0&&(0,s.jsx)("div",{className:"md:hidden border-t border-white/10 pt-3 pb-2",children:(0,s.jsx)("div",{className:"flex items-center gap-3 overflow-x-auto",children:f.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[t>0&&(0,s.jsx)("span",{className:"text-white/50 text-sm",children:"›"}),(0,s.jsx)(a.default,{href:e.href,children:(0,s.jsx)("span",{className:"text-sm text-white/80 whitespace-nowrap",children:e.label})})]},e.href))})})]})})})}},4042:function(e,t,n){"use strict";n.d(t,{default:function(){return i}});var s=n(7437),a=n(2265),r=n(357);function i(){let{isInstallable:e,isOnline:t,installApp:n}=function(){let[e,t]=(0,a.useState)(!1),[n,s]=(0,a.useState)(!1),[i,l]=(0,a.useState)(!0),[o,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(null);(0,a.useEffect)(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(e=>{console.log("✅ Service Worker registered successfully:",e),u(e),e.addEventListener("updatefound",()=>{let t=e.installing;t&&t.addEventListener("statechange",()=>{"installed"===t.state&&navigator.serviceWorker.controller&&(console.log("\uD83D\uDD04 Nueva versi\xf3n disponible"),m())})})}).catch(e=>{console.error("❌ Service Worker registration failed:",e)})},[]),(0,a.useEffect)(()=>{let e=e=>{e.preventDefault(),c(e),t(!0),console.log("\uD83D\uDCF1 App is installable")},n=()=>{s(!0),t(!1),c(null),console.log("\uD83C\uDF89 App installed successfully")};return window.addEventListener("beforeinstallprompt",e),window.addEventListener("appinstalled",n),()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",n)}},[]),(0,a.useEffect)(()=>{let e=()=>{l(!0),console.log("\uD83C\uDF10 Connection restored")},t=()=>{l(!1),console.log("\uD83D\uDCF4 Connection lost")};return l(navigator.onLine),window.addEventListener("online",e),window.addEventListener("offline",t),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}},[]),(0,a.useEffect)(()=>{window.matchMedia("(display-mode: standalone)").matches&&(s(!0),console.log("\uD83D\uDCF1 App running in standalone mode")),!0===window.navigator.standalone&&(s(!0),console.log("\uD83D\uDCF1 App running in iOS standalone mode"))},[]);let m=()=>{"Notification"in window&&"granted"===Notification.permission?new Notification("Nueva versi\xf3n disponible",{body:"Hay una nueva versi\xf3n de Robux disponible. Recarga la p\xe1gina para actualizarla.",icon:"/icons/icon-192x192.png",tag:"app-update"}):console.log("\uD83D\uDD04 Nueva versi\xf3n disponible - recarga la p\xe1gina")};return{isInstallable:e,isInstalled:n,isOnline:i,installApp:async()=>{if(!o)return!1;try{await o.prompt();let{outcome:e}=await o.userChoice;if("accepted"===e)return console.log("✅ User accepted the install prompt"),t(!1),c(null),!0;return console.log("❌ User dismissed the install prompt"),!1}catch(e){return console.error("Error installing app:",e),!1}},updateApp:()=>{d&&d.waiting&&(d.waiting.postMessage({type:"SKIP_WAITING"}),window.location.reload())},requestNotificationPermission:async()=>{if("Notification"in window){let e=await Notification.requestPermission();return console.log("\uD83D\uDD14 Notification permission:",e),"granted"===e}return!1},subscribeToPushNotifications:async()=>{if(!d)return null;try{let e=await d.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:r.env.NEXT_PUBLIC_VAPID_PUBLIC_KEY});return console.log("\uD83D\uDCE9 Push subscription:",e),e}catch(e){return console.error("Error subscribing to push notifications:",e),null}},swRegistration:d}}(),i=async()=>{await n()&&console.log("\uD83C\uDF89 App installed successfully!")};return(0,s.jsxs)(s.Fragment,{children:[e&&(0,s.jsx)("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-96 bg-gradient-to-r from-purple-600 to-blue-600 text-white p-4 rounded-lg shadow-lg z-50 border border-purple-500/30",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"text-2xl",children:"\uD83D\uDCF1"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"font-semibold text-sm",children:"Instalar App"}),(0,s.jsx)("p",{className:"text-xs opacity-90",children:"Instala Robux para un acceso m\xe1s r\xe1pido y funcionalidad offline"})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{onClick:i,className:"bg-white/20 hover:bg-white/30 px-3 py-1 rounded text-xs font-medium transition-colors",children:"Instalar"}),(0,s.jsx)("button",{onClick:()=>{let e=document.querySelector("[data-pwa-banner]");e&&e.remove()},className:"text-white/70 hover:text-white text-lg",children:"\xd7"})]})]})}),!t&&(0,s.jsx)("div",{className:"fixed top-16 left-1/2 transform -translate-x-1/2 bg-red-600 text-white px-4 py-2 rounded-lg shadow-lg z-50 text-sm",children:"\uD83D\uDCF4 Sin conexi\xf3n - Modo offline activo"})]})}},7087:function(e,t,n){"use strict";n.d(t,{default:function(){return o}});var s=n(7437),a=n(2265);let r=(0,a.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});try{require("@emotion/is-prop-valid").default}catch(e){}function i(e){let{children:t,isValidProp:n,...i}=e;(i={...(0,a.useContext)(r),...i}).isStatic=function(e){let t=(0,a.useRef)(null);return null===t.current&&(t.current=e()),t.current}(()=>i.isStatic);let l=(0,a.useMemo)(()=>i,[JSON.stringify(i.transition),i.transformPagePoint,i.reducedMotion]);return(0,s.jsx)(r.Provider,{value:l,children:t})}var l=n(3259);function o(e){let{children:t}=e;return(0,s.jsx)(i,{reducedMotion:"user",children:(0,s.jsx)(l.H,{children:t})})}},5976:function(e,t,n){"use strict";n.d(t,{z:function(){return r}});var s=n(2265),a=n(3259);function r(){let[e,t]=(0,s.useState)([]),[n,r]=(0,s.useState)(0),[i,l]=(0,s.useState)(!0),{user:o}=(0,a.a)(),c=(0,s.useRef)(!1),d=(0,s.useCallback)(()=>{let e=(null==o?void 0:o.id)||(null==o?void 0:o.email)||"anonymous";return"notifications_".concat(e)},[null==o?void 0:o.id,null==o?void 0:o.email]),u=(0,s.useCallback)(e=>{try{localStorage.setItem(d(),JSON.stringify(e))}catch(e){console.error("Error guardando notificaciones:",e)}},[d]),m=(0,s.useCallback)(()=>{if(!c.current)try{let e=localStorage.getItem(d());if(e){let n=JSON.parse(e).filter(e=>new Date(e.expires_at)>new Date);t(n),r(n.filter(e=>!e.read).length)}else t([]),r(0)}catch(e){console.error("Error cargando notificaciones:",e),t([]),r(0)}finally{l(!1),c.current=!0}},[d]),h=(0,s.useCallback)(e=>{t(t=>{let n=t.filter(t=>t.id!==e);u(n);let s=t.find(t=>t.id===e);return s&&!s.read&&r(e=>Math.max(0,e-1)),n})},[u]),x=(0,s.useCallback)(()=>{t([]),r(0),localStorage.removeItem(d())},[d]),p=(0,s.useCallback)(e=>{t(t=>{let n=t.map(t=>t.id===e?{...t,read:!0}:t);u(n);let s=t.find(t=>t.id===e);return s&&!s.read&&r(e=>Math.max(0,e-1)),n})},[u]),f=(0,s.useCallback)(()=>{t(e=>{let t=e.map(e=>({...e,read:!0}));return u(t),r(0),t})},[u]),g=(0,s.useCallback)(function(e,n,s,a){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},l={id:crypto.randomUUID(),user_id:e,type:n,title:s,message:a,data:i,read:!1,created_at:new Date().toISOString(),expires_at:new Date(Date.now()+2592e6).toISOString()};return t(e=>{let t=[l,...e].slice(0,50);return u(t),r(e=>e+1),t}),!0},[u]),v=(0,s.useCallback)(()=>{t(e=>{let t=e.filter(e=>new Date(e.expires_at)>new Date);return t.length!==e.length&&(u(t),r(t.filter(e=>!e.read).length)),t})},[u]),b=(0,s.useCallback)(t=>e.filter(e=>e.type===t),[e]),w=(0,s.useCallback)(()=>({total:e.length,unread:n,read:e.length-n,byType:{system:e.filter(e=>"system"===e.type).length,comment:e.filter(e=>"comment"===e.type).length,post_published:e.filter(e=>"post_published"===e.type).length,essay_uploaded:e.filter(e=>"essay_uploaded"===e.type).length,mention:e.filter(e=>"mention"===e.type).length}}),[e,n]),j=(0,s.useCallback)((e,n)=>(t(t=>{let s=t.map(t=>t.id===e?{...t,...n}:t);return u(s),s}),!0),[u]);return(0,s.useEffect)(()=>{o&&!c.current&&m()},[o,m]),{notifications:e,unreadCount:n,loading:i,markAsRead:p,markAllAsRead:f,deleteNotification:h,deleteAllNotifications:x,createNotification:g,editNotification:j,cleanExpiredNotifications:v,getNotificationsByType:b,getStats:w,refresh:m}}},6463:function(e,t,n){"use strict";var s=n(1169);n.o(s,"notFound")&&n.d(t,{notFound:function(){return s.notFound}}),n.o(s,"usePathname")&&n.d(t,{usePathname:function(){return s.usePathname}}),n.o(s,"useRouter")&&n.d(t,{useRouter:function(){return s.useRouter}})},8877:function(){}},function(e){e.O(0,[404,835,138,320,971,23,744],function(){return e(e.s=3932)}),_N_E=e.O()}]);